<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <p>xử lý bất đồng bộ khắc phục callback hell , 6</p>
</body>
<script>
    // 3 trang thai
    // 1. Pendding (chờ xem thất bại hay thành công);
    // 2. fulfilled (thành công )
    // 3. rejected (thất bại)

    // Promise là một object contructor 
    var promise = new Promise(
        // Executor 
        // hai đối số là hàm 
        function (resolve, reject) {
            //Logic 
            // khi thành công 
            resolve();
        }
    );

    promise
        // thành công
        .then(function () {
            // console.log("thanh cong 1");         //1
            // return 1 ;

            return new Promise(function (resolve) { // 2
                setTimeout(function () {
                    resolve([1, 2, 3]);
                }, 3000); // sau 3s mới chạy then tiếp theo
            });
        })
        .then(function (data) {
            console.log("thanh cong 2");
            // data là kết quả của việc return thằng then trước 
            console.log(data); // 1 
            console.log(data); // 2 sau khi thằng then trước return về một promise thì thằng prosime đó . then sau này
        })
        .then(function () {
            console.log("thanh cong 3");
        })
        //thất bại 
        .catch(function (err) {
            console.log(err);
        })
        .finally(function () {
            console.log("hoan thanh");
        })
</script>

</html>